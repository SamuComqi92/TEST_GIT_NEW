expression 'PSR Card4-Card11' =
		let
		    Source = AnalysisServices.Database("powerbi://api.powerbi.com/v1.0/myorg/RISCOP%20BI%20%26%20REPORTING", "PSR Data Model", [TypedMeasureColumns=true, Implementation="2.0"]),
		    Model1 = Source{[Id="Model"]}[Data],
		    Model2 = Model1{[Id="Model"]}[Data],
		    #"Added Items" = Cube.Transform(Model2,
		        {
		            {Cube.AddAndExpandDimensionColumn, "[PSR5_Card11_Progress]", {"[PSR5_Card11_Progress].[Cumulative_Actual_Progress].[Cumulative_Actual_Progress]", "[PSR5_Card11_Progress].[Cumulative_Plan_Progress].[Cumulative_Plan_Progress]", "[PSR5_Card11_Progress].[Date_Upload].[Date_Upload]", "[PSR5_Card11_Progress].[Error_Upload].[Error_Upload]", "[PSR5_Card11_Progress].[Forecast_Next_Month_Progress].[Forecast_Next_Month_Progress]", "[PSR5_Card11_Progress].[ID].[ID]", "[PSR5_Card11_Progress].[Item_Description].[Item_Description]", "[PSR5_Card11_Progress].[Monthly_Actual_Progress].[Monthly_Actual_Progress]", "[PSR5_Card11_Progress].[Monthly_Plan_Progress].[Monthly_Plan_Progress]", "[PSR5_Card11_Progress].[P_Key].[P_Key]", "[PSR5_Card11_Progress].[Progress_Trend].[Progress_Trend]", "[PSR5_Card11_Progress].[Relative_Weight].[Relative_Weight]", "[PSR5_Card11_Progress].[Remarks].[Remarks]"}, {"PSR5_Card11_Progress.Cumulative_Actual_Progress", "PSR5_Card11_Progress.Cumulative_Plan_Progress", "PSR5_Card11_Progress.Date_Upload", "PSR5_Card11_Progress.Error_Upload", "PSR5_Card11_Progress.Forecast_Next_Month_Progress", "PSR5_Card11_Progress.ID", "PSR5_Card11_Progress.Item_Description", "PSR5_Card11_Progress.Monthly_Actual_Progress", "PSR5_Card11_Progress.Monthly_Plan_Progress", "PSR5_Card11_Progress.P_Key", "PSR5_Card11_Progress.Progress_Trend", "PSR5_Card11_Progress.Relative_Weight", "PSR5_Card11_Progress.Remarks"}}
		        }),
		    #"Exctract Column Names" = Table.TransformColumnNames(#"Added Items", each Text.AfterDelimiter(_, "PSR5_Card11_Progress.")),
		    #"Removed Other Columns" = Table.SelectColumns(#"Exctract Column Names",{"Item_Description", "P_Key", "Cumulative_Actual_Progress", "Cumulative_Plan_Progress"}),
		    #"Unpivoted Columns" = Table.UnpivotOtherColumns(#"Removed Other Columns", {"Item_Description", "P_Key"}, "Attribute", "Value"),
		    #"Replaced Value" = Table.ReplaceValue(#"Unpivoted Columns","Cumulative_","",Replacer.ReplaceText,{"Attribute"}),
		    #"Merged Columns" = Table.CombineColumns(#"Replaced Value",{"Item_Description", "Attribute"},Combiner.CombineTextByDelimiter("_", QuoteStyle.None),"Field"),
		    #"Pivoted Column" = Table.Pivot(#"Merged Columns", List.Distinct(#"Merged Columns"[Field]), "Field", "Value")
		in
		    #"Pivoted Column"
	lineageTag: 784bd300-260e-4a8a-a69f-75cc935a87ce
	queryGroup: 'Tables not loaded'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression PSR_Card02_Project_Overview =
		let
		    Source = AnalysisServices.Database("powerbi://api.powerbi.com/v1.0/myorg/RISCOP%20BI%20%26%20REPORTING", "PSR Data Model", [TypedMeasureColumns=true, Implementation="2.0"]),
		    Model1 = Source{[Id="Model"]}[Data],
		    Model2 = Model1{[Id="Model"]}[Data],
		    #"Added Items" = Cube.Transform(Model2,
		        {
		            {Cube.AddAndExpandDimensionColumn, "[PSR5_Card02_Project_Overview]", {"[PSR5_Card02_Project_Overview].[Achieved_EUReq].[Achieved_EUReq]", "[PSR5_Card02_Project_Overview].[Achieved_perc].[Achieved_perc]", "[PSR5_Card02_Project_Overview].[Arbitration_Law].[Arbitration_Law]", "[PSR5_Card02_Project_Overview].[Autofill_Date_02].[Autofill_Date_02]", "[PSR5_Card02_Project_Overview].[Autofill_Name_02].[Autofill_Name_02]", "[PSR5_Card02_Project_Overview].[Bid_Initiative_Number].[Bid_Initiative_Number]", "[PSR5_Card02_Project_Overview].[Business_Manager].[Business_Manager]", "[PSR5_Card02_Project_Overview].[Business_OP_Manager].[Business_OP_Manager]", "[PSR5_Card02_Project_Overview].[Client].[Client]", "[PSR5_Card02_Project_Overview].[Client_Project_Manager].[Client_Project_Manager]", "[PSR5_Card02_Project_Overview].[Contract_Duration].[Contract_Duration]", "[PSR5_Card02_Project_Overview].[Contract_Manager].[Contract_Manager]", "[PSR5_Card02_Project_Overview].[Cost_Controller].[Cost_Controller]", "[PSR5_Card02_Project_Overview].[Country_Area].[Country_Area]", "[PSR5_Card02_Project_Overview].[Date_Upload].[Date_Upload]", "[PSR5_Card02_Project_Overview].[DMS_Job_Number].[DMS_Job_Number]", "[PSR5_Card02_Project_Overview].[Economic_Progress_Current_Year].[Economic_Progress_Current_Year]", "[PSR5_Card02_Project_Overview].[Economic_Progress_Entire_Life].[Economic_Progress_Entire_Life]", "[PSR5_Card02_Project_Overview].[Equalization_Margin_Actual].[Equalization_Margin_Actual]", "[PSR5_Card02_Project_Overview].[Error_Upload].[Error_Upload]", "[PSR5_Card02_Project_Overview].[Exchange_Rate_Download_Date].[Exchange_Rate_Download_Date]", "[PSR5_Card02_Project_Overview].[Exchange_Rate_Forecast_Session].[Exchange_Rate_Forecast_Session]", "[PSR5_Card02_Project_Overview].[ID].[ID]", "[PSR5_Card02_Project_Overview].[Invoiced_EUReq].[Invoiced_EUReq]", "[PSR5_Card02_Project_Overview].[Invoiced_perc].[Invoiced_perc]", "[PSR5_Card02_Project_Overview].[Is_Reimbursable].[Is_Reimbursable]", "[PSR5_Card02_Project_Overview].[Long_Name].[Long_Name]", "[PSR5_Card02_Project_Overview].[Outstanding_Overdue_Amount_Total_EUReq].[Outstanding_Overdue_Amount_Total_EUReq]", "[PSR5_Card02_Project_Overview].[Outstanding_Overdue_Amount_Total_perc].[Outstanding_Overdue_Amount_Total_perc]", "[PSR5_Card02_Project_Overview].[Outstanding_Overdue_Below_12_Months_EUReq].[Outstanding_Overdue_Below_12_Months_EUReq]", "[PSR5_Card02_Project_Overview].[Outstanding_Overdue_Below_12_Months_perc].[Outstanding_Overdue_Below_12_Months_perc]", "[PSR5_Card02_Project_Overview].[Outstanding_Overdue_Not_Due_EUReq].[Outstanding_Overdue_Not_Due_EUReq]", "[PSR5_Card02_Project_Overview].[Outstanding_Overdue_Not_Due_perc].[Outstanding_Overdue_Not_Due_perc]", "[PSR5_Card02_Project_Overview].[Outstanding_Overdue_Over_12_Months_EUReq].[Outstanding_Overdue_Over_12_Months_EUReq]", "[PSR5_Card02_Project_Overview].[Outstanding_Overdue_Over_12_Months_perc].[Outstanding_Overdue_Over_12_Months_perc]", "[PSR5_Card02_Project_Overview].[Outstanding_Total_EUReq].[Outstanding_Total_EUReq]", "[PSR5_Card02_Project_Overview].[Outstanding_Total_perc].[Outstanding_Total_perc]", "[PSR5_Card02_Project_Overview].[P_Key].[P_Key]", "[PSR5_Card02_Project_Overview].[Paid_EUReq].[Paid_EUReq]", "[PSR5_Card02_Project_Overview].[Paid_perc].[Paid_perc]", "[PSR5_Card02_Project_Overview].[Partnership].[Partnership]", "[PSR5_Card02_Project_Overview].[Planning_Manager].[Planning_Manager]", "[PSR5_Card02_Project_Overview].[Portfolio_Area_Manager].[Portfolio_Area_Manager]", "[PSR5_Card02_Project_Overview].[Product_Commercial_Classification].[Product_Commercial_Classification]", "[PSR5_Card02_Project_Overview].[Proj_Class_Type].[Proj_Class_Type]", "[PSR5_Card02_Project_Overview].[Project_Control_Manager].[Project_Control_Manager]", "[PSR5_Card02_Project_Overview].[Project_Director].[Project_Director]", "[PSR5_Card02_Project_Overview].[Project_Manager].[Project_Manager]", "[PSR5_Card02_Project_Overview].[Prov_Anticipated_Loss_Actual].[Prov_Anticipated_Loss_Actual]", "[PSR5_Card02_Project_Overview].[Remarks_Total].[Remarks_Total]", "[PSR5_Card02_Project_Overview].[Remarks_Year].[Remarks_Year]", "[PSR5_Card02_Project_Overview].[Risk_Manager].[Risk_Manager]", "[PSR5_Card02_Project_Overview].[Scope_of_Work].[Scope_of_Work]", "[PSR5_Card02_Project_Overview].[Short_Name].[Short_Name]", "[PSR5_Card02_Project_Overview].[Technical_Manager].[Technical_Manager]", "[PSR5_Card02_Project_Overview].[Unprotect_Date_02].[Unprotect_Date_02]", "[PSR5_Card02_Project_Overview].[Unprotect_Name_02].[Unprotect_Name_02]"}, {"PSR5_Card02_Project_Overview.Achieved_EUReq", "PSR5_Card02_Project_Overview.Achieved_perc", "PSR5_Card02_Project_Overview.Arbitration_Law", "PSR5_Card02_Project_Overview.Autofill_Date_02", "PSR5_Card02_Project_Overview.Autofill_Name_02", "PSR5_Card02_Project_Overview.Bid_Initiative_Number", "PSR5_Card02_Project_Overview.Business_Manager", "PSR5_Card02_Project_Overview.Business_OP_Manager", "PSR5_Card02_Project_Overview.Client", "PSR5_Card02_Project_Overview.Client_Project_Manager", "PSR5_Card02_Project_Overview.Contract_Duration", "PSR5_Card02_Project_Overview.Contract_Manager", "PSR5_Card02_Project_Overview.Cost_Controller", "PSR5_Card02_Project_Overview.Country_Area", "PSR5_Card02_Project_Overview.Date_Upload", "PSR5_Card02_Project_Overview.DMS_Job_Number", "PSR5_Card02_Project_Overview.Economic_Progress_Current_Year", "PSR5_Card02_Project_Overview.Economic_Progress_Entire_Life", "PSR5_Card02_Project_Overview.Equalization_Margin_Actual", "PSR5_Card02_Project_Overview.Error_Upload", "PSR5_Card02_Project_Overview.Exchange_Rate_Download_Date", "PSR5_Card02_Project_Overview.Exchange_Rate_Forecast_Session", "PSR5_Card02_Project_Overview.ID", "PSR5_Card02_Project_Overview.Invoiced_EUReq", "PSR5_Card02_Project_Overview.Invoiced_perc", "PSR5_Card02_Project_Overview.Is_Reimbursable", "PSR5_Card02_Project_Overview.Long_Name", "PSR5_Card02_Project_Overview.Outstanding_Overdue_Amount_Total_EUReq", "PSR5_Card02_Project_Overview.Outstanding_Overdue_Amount_Total_perc", "PSR5_Card02_Project_Overview.Outstanding_Overdue_Below_12_Months_EUReq", "PSR5_Card02_Project_Overview.Outstanding_Overdue_Below_12_Months_perc", "PSR5_Card02_Project_Overview.Outstanding_Overdue_Not_Due_EUReq", "PSR5_Card02_Project_Overview.Outstanding_Overdue_Not_Due_perc", "PSR5_Card02_Project_Overview.Outstanding_Overdue_Over_12_Months_EUReq", "PSR5_Card02_Project_Overview.Outstanding_Overdue_Over_12_Months_perc", "PSR5_Card02_Project_Overview.Outstanding_Total_EUReq", "PSR5_Card02_Project_Overview.Outstanding_Total_perc", "PSR5_Card02_Project_Overview.P_Key", "PSR5_Card02_Project_Overview.Paid_EUReq", "PSR5_Card02_Project_Overview.Paid_perc", "PSR5_Card02_Project_Overview.Partnership", "PSR5_Card02_Project_Overview.Planning_Manager", "PSR5_Card02_Project_Overview.Portfolio_Area_Manager", "PSR5_Card02_Project_Overview.Product_Commercial_Classification", "PSR5_Card02_Project_Overview.Proj_Class_Type", "PSR5_Card02_Project_Overview.Project_Control_Manager", "PSR5_Card02_Project_Overview.Project_Director", "PSR5_Card02_Project_Overview.Project_Manager", "PSR5_Card02_Project_Overview.Prov_Anticipated_Loss_Actual", "PSR5_Card02_Project_Overview.Remarks_Total", "PSR5_Card02_Project_Overview.Remarks_Year", "PSR5_Card02_Project_Overview.Risk_Manager", "PSR5_Card02_Project_Overview.Scope_of_Work", "PSR5_Card02_Project_Overview.Short_Name", "PSR5_Card02_Project_Overview.Technical_Manager", "PSR5_Card02_Project_Overview.Unprotect_Date_02", "PSR5_Card02_Project_Overview.Unprotect_Name_02"}}
		        }),
		    #"Changed Type" = Table.TransformColumnTypes(#"Added Items",{{"PSR5_Card02_Project_Overview.Economic_Progress_Entire_Life", type number}, {"PSR5_Card02_Project_Overview.Achieved_EUReq", type number}})
		in
		    #"Changed Type"
	lineageTag: 39d2d728-c5ed-4da3-a8a9-31cd9c589fcc
	queryGroup: 'Tables not loaded'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Exception

expression PSR_Card03_Project_Summary =
		let
		    Source = AnalysisServices.Database("powerbi://api.powerbi.com/v1.0/myorg/RISCOP%20BI%20%26%20REPORTING", "PSR Data Model", [TypedMeasureColumns=true, Implementation="2.0"]),
		    Model1 = Source{[Id="Model"]}[Data],
		    Model2 = Model1{[Id="Model"]}[Data],
		    #"Added Items" = Cube.Transform(Model2,
		        {
		            {Cube.AddAndExpandDimensionColumn, "[PSR5_Card03_Project_Summary]", {"[PSR5_Card03_Project_Summary].[Company].[Company]", "[PSR5_Card03_Project_Summary].[Cons_Project].[Cons_Project]", "[PSR5_Card03_Project_Summary].[Consolidation_perc].[Consolidation_perc]", "[PSR5_Card03_Project_Summary].[Currency].[Currency]", "[PSR5_Card03_Project_Summary].[Current_Year_ActualToDate].[Current_Year_ActualToDate]", "[PSR5_Card03_Project_Summary].[Current_Year_Budget].[Current_Year_Budget]", "[PSR5_Card03_Project_Summary].[Current_Year_CF].[Current_Year_CF]", "[PSR5_Card03_Project_Summary].[Current_Year_Deviation].[Current_Year_Deviation]", "[PSR5_Card03_Project_Summary].[Current_Year_PF].[Current_Year_PF]", "[PSR5_Card03_Project_Summary].[Date_Upload].[Date_Upload]", "[PSR5_Card03_Project_Summary].[Error_Upload].[Error_Upload]", "[PSR5_Card03_Project_Summary].[Following_Years].[Following_Years]", "[PSR5_Card03_Project_Summary].[ID].[ID]", "[PSR5_Card03_Project_Summary].[Intercompany].[Intercompany]", "[PSR5_Card03_Project_Summary].[IsConsProjectLevel].[IsConsProjectLevel]", "[PSR5_Card03_Project_Summary].[Job_Number].[Job_Number]", "[PSR5_Card03_Project_Summary].[Line_Item].[Line_Item]", "[PSR5_Card03_Project_Summary].[Next_Year].[Next_Year]", "[PSR5_Card03_Project_Summary].[Next_Year1].[Next_Year1]", "[PSR5_Card03_Project_Summary].[Next_Year2].[Next_Year2]", "[PSR5_Card03_Project_Summary].[Next_Year3].[Next_Year3]", "[PSR5_Card03_Project_Summary].[Next_Year4].[Next_Year4]", "[PSR5_Card03_Project_Summary].[P_Key].[P_Key]", "[PSR5_Card03_Project_Summary].[Participation_perc].[Participation_perc]", "[PSR5_Card03_Project_Summary].[Saipem_Group_perc].[Saipem_Group_perc]", "[PSR5_Card03_Project_Summary].[Third_Party_perc].[Third_Party_perc]", "[PSR5_Card03_Project_Summary].[Total_Project_ActualToDate].[Total_Project_ActualToDate]", "[PSR5_Card03_Project_Summary].[Total_Project_Budget].[Total_Project_Budget]", "[PSR5_Card03_Project_Summary].[Total_Project_CF].[Total_Project_CF]", "[PSR5_Card03_Project_Summary].[Total_Project_Deviation].[Total_Project_Deviation]", "[PSR5_Card03_Project_Summary].[Total_Project_PF].[Total_Project_PF]", "[PSR5_Card03_Project_Summary].[Type].[Type]"}, {"PSR5_Card03_Project_Summary.Company", "PSR5_Card03_Project_Summary.Cons_Project", "PSR5_Card03_Project_Summary.Consolidation_perc", "PSR5_Card03_Project_Summary.Currency", "PSR5_Card03_Project_Summary.Current_Year_ActualToDate", "PSR5_Card03_Project_Summary.Current_Year_Budget", "PSR5_Card03_Project_Summary.Current_Year_CF", "PSR5_Card03_Project_Summary.Current_Year_Deviation", "PSR5_Card03_Project_Summary.Current_Year_PF", "PSR5_Card03_Project_Summary.Date_Upload", "PSR5_Card03_Project_Summary.Error_Upload", "PSR5_Card03_Project_Summary.Following_Years", "PSR5_Card03_Project_Summary.ID", "PSR5_Card03_Project_Summary.Intercompany", "PSR5_Card03_Project_Summary.IsConsProjectLevel", "PSR5_Card03_Project_Summary.Job_Number", "PSR5_Card03_Project_Summary.Line_Item", "PSR5_Card03_Project_Summary.Next_Year", "PSR5_Card03_Project_Summary.Next_Year1", "PSR5_Card03_Project_Summary.Next_Year2", "PSR5_Card03_Project_Summary.Next_Year3", "PSR5_Card03_Project_Summary.Next_Year4", "PSR5_Card03_Project_Summary.P_Key", "PSR5_Card03_Project_Summary.Participation_perc", "PSR5_Card03_Project_Summary.Saipem_Group_perc", "PSR5_Card03_Project_Summary.Third_Party_perc", "PSR5_Card03_Project_Summary.Total_Project_ActualToDate", "PSR5_Card03_Project_Summary.Total_Project_Budget", "PSR5_Card03_Project_Summary.Total_Project_CF", "PSR5_Card03_Project_Summary.Total_Project_Deviation", "PSR5_Card03_Project_Summary.Total_Project_PF", "PSR5_Card03_Project_Summary.Type"}}
		        })
		in
		    #"Added Items"
	lineageTag: 1d7a76f3-a369-43bd-8a80-3c8ae1a9ce00
	queryGroup: 'Tables not loaded'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Exception

expression PSR_PrevForecast =
		let
		    Source = AnalysisServices.Database("powerbi://api.powerbi.com/v1.0/myorg/RISCOP%20BI%20%26%20REPORTING", "PSR Report", [TypedMeasureColumns=true, Implementation="2.0"]),
		    Model1 = Source{[Id="Model"]}[Data],
		    Model2 = Model1{[Id="Model"]}[Data],
		    #"Added Items" = Cube.Transform(Model2,
		        {
		            {Cube.AddAndExpandDimensionColumn, "[PSR_PrevForecast]", {"[PSR_PrevForecast].[Bonus_Variations_Pending_Included].[Bonus_Variations_Pending_Included]", "[PSR_PrevForecast].[Bonus_Variations_Pending_Included_ENI].[Bonus_Variations_Pending_Included_ENI]", "[PSR_PrevForecast].[Bonus_Variations_TBI_Included].[Bonus_Variations_TBI_Included]", "[PSR_PrevForecast].[Bonus_Variations_TBI_Included_ENI].[Bonus_Variations_TBI_Included_ENI]", "[PSR_PrevForecast].[CF_Gross_Margin].[CF_Gross_Margin]", "[PSR_PrevForecast].[CF_Gross_Margin_Fixed_Rate].[CF_Gross_Margin_Fixed_Rate]", "[PSR_PrevForecast].[CF_K_Factor].[CF_K_Factor]", "[PSR_PrevForecast].[CF_Management_Contingencies].[CF_Management_Contingencies]", "[PSR_PrevForecast].[CF_Project_Contingencies].[CF_Project_Contingencies]", "[PSR_PrevForecast].[CF_Total_Revenues].[CF_Total_Revenues]", "[PSR_PrevForecast].[Change_Orders_Variations_Pending_Included].[Change_Orders_Variations_Pending_Included]", "[PSR_PrevForecast].[Change_Orders_Variations_Pending_Included_ENI].[Change_Orders_Variations_Pending_Included_ENI]", "[PSR_PrevForecast].[Change_Orders_Variations_TBI_Included].[Change_Orders_Variations_TBI_Included]", "[PSR_PrevForecast].[Change_Orders_Variations_TBI_Included_ENI].[Change_Orders_Variations_TBI_Included_ENI]", "[PSR_PrevForecast].[Claims_Variations_Pending_Included].[Claims_Variations_Pending_Included]", "[PSR_PrevForecast].[Claims_Variations_Pending_Included_ENI].[Claims_Variations_Pending_Included_ENI]", "[PSR_PrevForecast].[Claims_Variations_TBI_Included].[Claims_Variations_TBI_Included]", "[PSR_PrevForecast].[Claims_Variations_TBI_Included_ENI].[Claims_Variations_TBI_Included_ENI]", "[PSR_PrevForecast].[Cons_Project].[Cons_Project]", "[PSR_PrevForecast].[Costs_Progress_Economic_Cutoff].[Costs_Progress_Economic_Cutoff]", "[PSR_PrevForecast].[Costs_Progress_Progress_Cutoff].[Costs_Progress_Progress_Cutoff]", "[PSR_PrevForecast].[CumulatedToDate_perc_Actual_Overall].[CumulatedToDate_perc_Actual_Overall]", "[PSR_PrevForecast].[CumulatedToDate_perc_Late_Overall].[CumulatedToDate_perc_Late_Overall]", "[PSR_PrevForecast].[CumulatedToDate_perc_Plan_Early_Overall].[CumulatedToDate_perc_Plan_Early_Overall]", "[PSR_PrevForecast].[current_forecast_request].[current_forecast_request]", "[PSR_PrevForecast].[Economic_Cutoff].[Economic_Cutoff]", "[PSR_PrevForecast].[Economic_Progress_perc].[Economic_Progress_perc]", "[PSR_PrevForecast].[EL Pending ENI PF].[EL Pending ENI PF]", "[PSR_PrevForecast].[EL Pending PF].[EL Pending PF]", "[PSR_PrevForecast].[Forecast].[Forecast]", "[PSR_PrevForecast].[GMCL].[GMCL]", "[PSR_PrevForecast].[GMCL Score].[GMCL Score]", "[PSR_PrevForecast].[Gross_Margin_Next_Years_Forecast].[Gross_Margin_Next_Years_Forecast]", "[PSR_PrevForecast].[Gross_Margin_Total_Project_ActualToDate].[Gross_Margin_Total_Project_ActualToDate]", "[PSR_PrevForecast].[Gross_Margin_Total_Project_Budget].[Gross_Margin_Total_Project_Budget]", "[PSR_PrevForecast].[Gross_Margin_Total_Project_Current_Forecast].[Gross_Margin_Total_Project_Current_Forecast]", "[PSR_PrevForecast].[Gross_Margin_Total_Project_Official_PrevForecast].[Gross_Margin_Total_Project_Official_PrevForecast]", "[PSR_PrevForecast].[K_Factor_Next_Years_Forecast].[K_Factor_Next_Years_Forecast]", "[PSR_PrevForecast].[K_Factor_Total_Project_Budget].[K_Factor_Total_Project_Budget]", "[PSR_PrevForecast].[K_Factor_Total_Project_Current_Forecast].[K_Factor_Total_Project_Current_Forecast]", "[PSR_PrevForecast].[K_Factor_Total_Project_Official_PrevForecast].[K_Factor_Total_Project_Official_PrevForecast]", "[PSR_PrevForecast].[List_Data.P_Key].[List_Data.P_Key]", "[PSR_PrevForecast].[Management_Contingencies].[Management_Contingencies]", "[PSR_PrevForecast].[MaxIDPKEY].[MaxIDPKEY]", "[PSR_PrevForecast].[Net_Risk].[Net_Risk]", "[PSR_PrevForecast].[Next Forecast].[Next Forecast]", "[PSR_PrevForecast].[NextForecast_PKey].[NextForecast_PKey]", "[PSR_PrevForecast].[OCB_Gross_Margin].[OCB_Gross_Margin]", "[PSR_PrevForecast].[OCB_K_Factor].[OCB_K_Factor]", "[PSR_PrevForecast].[OCB_Management_Contingencies].[OCB_Management_Contingencies]", "[PSR_PrevForecast].[OCB_Project_Contingencies].[OCB_Project_Contingencies]", "[PSR_PrevForecast].[OCB_Total_Revenues].[OCB_Total_Revenues]", "[PSR_PrevForecast].[Opp_Expected_Current_Forecast_Total].[Opp_Expected_Current_Forecast_Total]", "[PSR_PrevForecast].[Opp_Occur_As_Prj_Conting_Total].[Opp_Occur_As_Prj_Conting_Total]", "[PSR_PrevForecast].[Opp_Occur_Effect_Margin_Impact_Total].[Opp_Occur_Effect_Margin_Impact_Total]", "[PSR_PrevForecast].[Opportunities].[Opportunities]", "[PSR_PrevForecast].[Options_Variations_Pending_Included].[Options_Variations_Pending_Included]", "[PSR_PrevForecast].[Options_Variations_Pending_Included_ENI].[Options_Variations_Pending_Included_ENI]", "[PSR_PrevForecast].[Options_Variations_TBI_Included].[Options_Variations_TBI_Included]", "[PSR_PrevForecast].[Options_Variations_TBI_Included_ENI].[Options_Variations_TBI_Included_ENI]", "[PSR_PrevForecast].[Overall_Project_Performance_Index_CPI].[Overall_Project_Performance_Index_CPI]", "[PSR_PrevForecast].[Overall_Project_Performance_Index_SPI].[Overall_Project_Performance_Index_SPI]", "[PSR_PrevForecast].[Penalties_Variations_Pending_Included].[Penalties_Variations_Pending_Included]", "[PSR_PrevForecast].[Penalties_Variations_Pending_Included_ENI].[Penalties_Variations_Pending_Included_ENI]", "[PSR_PrevForecast].[Penalties_Variations_TBI_Included].[Penalties_Variations_TBI_Included]", "[PSR_PrevForecast].[Penalties_Variations_TBI_Included_ENI].[Penalties_Variations_TBI_Included_ENI]", "[PSR_PrevForecast].[Physical_Progress_Economic_Cutoff].[Physical_Progress_Economic_Cutoff]", "[PSR_PrevForecast].[Physical_Progress_Progress_Cutoff].[Physical_Progress_Progress_Cutoff]", "[PSR_PrevForecast].[PrevForecast_PKey].[PrevForecast_PKey]", "[PSR_PrevForecast].[Previous Forecast].[Previous Forecast]", "[PSR_PrevForecast].[PrevYear].[PrevYear]", "[PSR_PrevForecast].[Progress_Cutoff].[Progress_Cutoff]", "[PSR_PrevForecast].[Project_Contingencies].[Project_Contingencies]", "[PSR_PrevForecast].[Provisional_Other_variation_Variations_Pending_Included].[Provisional_Other_variation_Variations_Pending_Included]", "[PSR_PrevForecast].[Provisional_Other_variation_Variations_Pending_Included_ENI].[Provisional_Other_variation_Variations_Pending_Included_ENI]", "[PSR_PrevForecast].[Provisional_Other_variation_Variations_TBI_Included].[Provisional_Other_variation_Variations_TBI_Included]", "[PSR_PrevForecast].[Provisional_Other_variation_Variations_TBI_Included_ENI].[Provisional_Other_variation_Variations_TBI_Included_ENI]", "[PSR_PrevForecast].[RCB_Gross_Margin].[RCB_Gross_Margin]", "[PSR_PrevForecast].[RCB_K_Factor].[RCB_K_Factor]", "[PSR_PrevForecast].[RCB_Management_Contingencies].[RCB_Management_Contingencies]", "[PSR_PrevForecast].[RCB_Project_Contingencies].[RCB_Project_Contingencies]", "[PSR_PrevForecast].[RCB_Total_Revenues].[RCB_Total_Revenues]", "[PSR_PrevForecast].[Reimbursable_Variations_Pending_Included].[Reimbursable_Variations_Pending_Included]", "[PSR_PrevForecast].[Reimbursable_Variations_Pending_Included_ENI].[Reimbursable_Variations_Pending_Included_ENI]", "[PSR_PrevForecast].[Reimbursable_Variations_TBI_Included].[Reimbursable_Variations_TBI_Included]", "[PSR_PrevForecast].[Reimbursable_Variations_TBI_Included_ENI].[Reimbursable_Variations_TBI_Included_ENI]", "[PSR_PrevForecast].[Risk].[Risk]", "[PSR_PrevForecast].[Risk_Exposure].[Risk_Exposure]", "[PSR_PrevForecast].[Risks_Expected_Current_Forecast_Total].[Risks_Expected_Current_Forecast_Total]", "[PSR_PrevForecast].[Risks_Occur_Utilized_Conting_Total].[Risks_Occur_Utilized_Conting_Total]", "[PSR_PrevForecast].[Risks_Residual_Expected_Current_Forecast_Total].[Risks_Residual_Expected_Current_Forecast_Total]", "[PSR_PrevForecast].[Session].[Session]", "[PSR_PrevForecast].[Total_Opportunities_OCB].[Total_Opportunities_OCB]", "[PSR_PrevForecast].[Total_Opportunities_RCB].[Total_Opportunities_RCB]", "[PSR_PrevForecast].[Total_Revenues_Next_Years_Current_Forecast].[Total_Revenues_Next_Years_Current_Forecast]", "[PSR_PrevForecast].[Total_Revenues_Total_Project_ActualToDate].[Total_Revenues_Total_Project_ActualToDate]", "[PSR_PrevForecast].[Total_Revenues_Total_Project_Budget].[Total_Revenues_Total_Project_Budget]", "[PSR_PrevForecast].[Total_Revenues_Total_Project_Current_Forecast].[Total_Revenues_Total_Project_Current_Forecast]", "[PSR_PrevForecast].[Total_Revenues_Total_Project_Official_PrevForecast].[Total_Revenues_Total_Project_Official_PrevForecast]", "[PSR_PrevForecast].[Total_Risk_OCB].[Total_Risk_OCB]", "[PSR_PrevForecast].[Total_Risk_RCB].[Total_Risk_RCB]", "[PSR_PrevForecast].[VAR 75 Score].[VAR 75 Score]", "[PSR_PrevForecast].[VAR_50].[VAR_50]", "[PSR_PrevForecast].[VAR_75].[VAR_75]", "[PSR_PrevForecast].[Year].[Year]"}, {"PSR_PrevForecast.Bonus_Variations_Pending_Included", "PSR_PrevForecast.Bonus_Variations_Pending_Included_ENI", "PSR_PrevForecast.Bonus_Variations_TBI_Included", "PSR_PrevForecast.Bonus_Variations_TBI_Included_ENI", "PSR_PrevForecast.CF_Gross_Margin", "PSR_PrevForecast.CF_Gross_Margin_Fixed_Rate", "PSR_PrevForecast.CF_K_Factor", "PSR_PrevForecast.CF_Management_Contingencies", "PSR_PrevForecast.CF_Project_Contingencies", "PSR_PrevForecast.CF_Total_Revenues", "PSR_PrevForecast.Change_Orders_Variations_Pending_Included", "PSR_PrevForecast.Change_Orders_Variations_Pending_Included_ENI", "PSR_PrevForecast.Change_Orders_Variations_TBI_Included", "PSR_PrevForecast.Change_Orders_Variations_TBI_Included_ENI", "PSR_PrevForecast.Claims_Variations_Pending_Included", "PSR_PrevForecast.Claims_Variations_Pending_Included_ENI", "PSR_PrevForecast.Claims_Variations_TBI_Included", "PSR_PrevForecast.Claims_Variations_TBI_Included_ENI", "PSR_PrevForecast.Cons_Project", "PSR_PrevForecast.Costs_Progress_Economic_Cutoff", "PSR_PrevForecast.Costs_Progress_Progress_Cutoff", "PSR_PrevForecast.CumulatedToDate_perc_Actual_Overall", "PSR_PrevForecast.CumulatedToDate_perc_Late_Overall", "PSR_PrevForecast.CumulatedToDate_perc_Plan_Early_Overall", "PSR_PrevForecast.current_forecast_request", "PSR_PrevForecast.Economic_Cutoff", "PSR_PrevForecast.Economic_Progress_perc", "PSR_PrevForecast.EL Pending ENI PF", "PSR_PrevForecast.EL Pending PF", "PSR_PrevForecast.Forecast", "PSR_PrevForecast.GMCL", "PSR_PrevForecast.GMCL Score", "PSR_PrevForecast.Gross_Margin_Next_Years_Forecast", "PSR_PrevForecast.Gross_Margin_Total_Project_ActualToDate", "PSR_PrevForecast.Gross_Margin_Total_Project_Budget", "PSR_PrevForecast.Gross_Margin_Total_Project_Current_Forecast", "PSR_PrevForecast.Gross_Margin_Total_Project_Official_PrevForecast", "PSR_PrevForecast.K_Factor_Next_Years_Forecast", "PSR_PrevForecast.K_Factor_Total_Project_Budget", "PSR_PrevForecast.K_Factor_Total_Project_Current_Forecast", "PSR_PrevForecast.K_Factor_Total_Project_Official_PrevForecast", "PSR_PrevForecast.List_Data.P_Key", "PSR_PrevForecast.Management_Contingencies", "PSR_PrevForecast.MaxIDPKEY", "PSR_PrevForecast.Net_Risk", "PSR_PrevForecast.Next Forecast", "PSR_PrevForecast.NextForecast_PKey", "PSR_PrevForecast.OCB_Gross_Margin", "PSR_PrevForecast.OCB_K_Factor", "PSR_PrevForecast.OCB_Management_Contingencies", "PSR_PrevForecast.OCB_Project_Contingencies", "PSR_PrevForecast.OCB_Total_Revenues", "PSR_PrevForecast.Opp_Expected_Current_Forecast_Total", "PSR_PrevForecast.Opp_Occur_As_Prj_Conting_Total", "PSR_PrevForecast.Opp_Occur_Effect_Margin_Impact_Total", "PSR_PrevForecast.Opportunities", "PSR_PrevForecast.Options_Variations_Pending_Included", "PSR_PrevForecast.Options_Variations_Pending_Included_ENI", "PSR_PrevForecast.Options_Variations_TBI_Included", "PSR_PrevForecast.Options_Variations_TBI_Included_ENI", "PSR_PrevForecast.Overall_Project_Performance_Index_CPI", "PSR_PrevForecast.Overall_Project_Performance_Index_SPI", "PSR_PrevForecast.Penalties_Variations_Pending_Included", "PSR_PrevForecast.Penalties_Variations_Pending_Included_ENI", "PSR_PrevForecast.Penalties_Variations_TBI_Included", "PSR_PrevForecast.Penalties_Variations_TBI_Included_ENI", "PSR_PrevForecast.Physical_Progress_Economic_Cutoff", "PSR_PrevForecast.Physical_Progress_Progress_Cutoff", "PSR_PrevForecast.PrevForecast_PKey", "PSR_PrevForecast.Previous Forecast", "PSR_PrevForecast.PrevYear", "PSR_PrevForecast.Progress_Cutoff", "PSR_PrevForecast.Project_Contingencies", "PSR_PrevForecast.Provisional_Other_variation_Variations_Pending_Included", "PSR_PrevForecast.Provisional_Other_variation_Variations_Pending_Included_ENI", "PSR_PrevForecast.Provisional_Other_variation_Variations_TBI_Included", "PSR_PrevForecast.Provisional_Other_variation_Variations_TBI_Included_ENI", "PSR_PrevForecast.RCB_Gross_Margin", "PSR_PrevForecast.RCB_K_Factor", "PSR_PrevForecast.RCB_Management_Contingencies", "PSR_PrevForecast.RCB_Project_Contingencies", "PSR_PrevForecast.RCB_Total_Revenues", "PSR_PrevForecast.Reimbursable_Variations_Pending_Included", "PSR_PrevForecast.Reimbursable_Variations_Pending_Included_ENI", "PSR_PrevForecast.Reimbursable_Variations_TBI_Included", "PSR_PrevForecast.Reimbursable_Variations_TBI_Included_ENI", "PSR_PrevForecast.Risk", "PSR_PrevForecast.Risk_Exposure", "PSR_PrevForecast.Risks_Expected_Current_Forecast_Total", "PSR_PrevForecast.Risks_Occur_Utilized_Conting_Total", "PSR_PrevForecast.Risks_Residual_Expected_Current_Forecast_Total", "PSR_PrevForecast.Session", "PSR_PrevForecast.Total_Opportunities_OCB", "PSR_PrevForecast.Total_Opportunities_RCB", "PSR_PrevForecast.Total_Revenues_Next_Years_Current_Forecast", "PSR_PrevForecast.Total_Revenues_Total_Project_ActualToDate", "PSR_PrevForecast.Total_Revenues_Total_Project_Budget", "PSR_PrevForecast.Total_Revenues_Total_Project_Current_Forecast", "PSR_PrevForecast.Total_Revenues_Total_Project_Official_PrevForecast", "PSR_PrevForecast.Total_Risk_OCB", "PSR_PrevForecast.Total_Risk_RCB", "PSR_PrevForecast.VAR 75 Score", "PSR_PrevForecast.VAR_50", "PSR_PrevForecast.VAR_75", "PSR_PrevForecast.Year"}},
		            {Cube.AddMeasureColumn, "Delta PRR", "[Measures].[Delta PRR]"},
		            {Cube.AddMeasureColumn, "Deviation Contingencies", "[Measures].[Deviation Contingencies]"},
		            {Cube.AddMeasureColumn, "Deviation Opportunities Expected", "[Measures].[Deviation Opportunities Expected]"},
		            {Cube.AddMeasureColumn, "Deviation Risk Expected", "[Measures].[Deviation Risk Expected]"},
		            {Cube.AddMeasureColumn, "Deviation VAR 50", "[Measures].[Deviation VAR 50]"},
		            {Cube.AddMeasureColumn, "Deviation VAR 75", "[Measures].[Deviation VAR 75]"},
		            {Cube.AddMeasureColumn, "PF Contingencies", "[Measures].[PF Contingencies]"},
		            {Cube.AddMeasureColumn, "PF PRR", "[Measures].[PF PRR]"},
		            {Cube.AddMeasureColumn, "PF PRR Color", "[Measures].[PF PRR Color]"}
		        })
		in
		    #"Added Items"
	lineageTag: 66f0f156-4700-4129-a1d9-1b270e00c054
	queryGroup: 'Tables not loaded'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression tmp_RiskRegisterReport =
		let
		    Origine = Sql.Database("we-sqldbserver-pr-irm01.database.windows.net", "we-sqldb-pr-irm01"),
		    dbo_tmp_RiskRegisterReport = Origine{[Schema="dbo",Item="tmp_RiskRegisterReport"]}[Data],
		    #"Changed Type" = Table.TransformColumnTypes(dbo_tmp_RiskRegisterReport,{{"Revenue", type number}})
		in
		    #"Changed Type"
	lineageTag: d62bee78-7d0e-4b78-bc64-27ccc1aa1530
	queryGroup: 'Tables not loaded'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Exception

expression Max_Forecast = ```
		let
		    Source = AnalysisServices.Database("powerbi://api.powerbi.com/v1.0/myorg/RISCOP%20BI%20%26%20REPORTING", "PSR Report", [TypedMeasureColumns=true, Implementation="2.0"]),
		    Model1 = Source{[Id="Model"]}[Data],
		    Model2 = Model1{[Id="Model"]}[Data],
		    #"Added Items" = Cube.Transform(Model2,
		        {
		            {Cube.AddAndExpandDimensionColumn, "[List_Data_GroupBy]", {"[List_Data_GroupBy].[Forecast].[Forecast]", "[List_Data_GroupBy].[Year].[Year]"}, {"List_Data_GroupBy.Forecast", "List_Data_GroupBy.Year"}}
		        }),
		    #"Changed Type" = Table.TransformColumnTypes(#"Added Items",{{"List_Data_GroupBy.Year", Int64.Type}}),
		
		    // Colonna che crea l'ordinamento dei forecast
		    #"Added Custom" = Table.AddColumn(#"Changed Type", "Sort_forecast", each if [List_Data_GroupBy.Forecast] = "I Forecast" then 1 else if [List_Data_GroupBy.Forecast] = "II Forecast" then 2 else if [List_Data_GroupBy.Forecast] = "III Forecast" then 3 else if [List_Data_GroupBy.Forecast] = "Preliminary Balance" then 4 else if [List_Data_GroupBy.Forecast] = "Official Balance" then 5 else 0),
		    
		    // Variabile che prende l'anno massimo presente nei dati + Filtro i dati per l'anno massimo
		    Max_year = List.Max(#"Added Custom"[List_Data_GroupBy.Year]),
		    #"Filtered Rows" = Table.SelectRows(#"Added Custom", each ([List_Data_GroupBy.Year] = Max_year)),
		    
		    // Variabile che prende il numero sort massimo presente nei dati + Filtro i dati in base al valore trovato
		    Max_sort = List.Max(#"Filtered Rows"[Sort_forecast]),
		    #"Filtered Rows1" = Table.SelectRows(#"Filtered Rows", each ([Sort_forecast] = Max_sort)),
		
		    // Creazione stringa last available forcast
		    Max_forecast = Text.From(List.Max(#"Filtered Rows1"[List_Data_GroupBy.Year])) & "-" & List.Max(#"Filtered Rows1"[List_Data_GroupBy.Forecast])
		    //#"Added Custom1" = Table.AddColumn(#"Filtered Rows1", "Max_forecast", each Text.From([List_Data_GroupBy.Year]) & "-" & [List_Data_GroupBy.Forecast]),
		    //#"Removed Other Columns" = Table.SelectColumns(#"Added Custom1",{"Max_forecast"}),
		    //#"Changed Type1" = Table.TransformColumnTypes(#"Removed Other Columns",{{"Max_forecast", type text}})
		in
		    Max_forecast
		```
	lineageTag: f9ee7606-aa53-4eac-bf3c-347ab2198bbb

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Text

